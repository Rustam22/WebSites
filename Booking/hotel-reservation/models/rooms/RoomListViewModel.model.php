<?phpclass RoomListViewModel extends CRUDModel {	public $r_id;	public $lang_id;	public $mainTitle;	public $content;	public $date;	public $image;	public $mainImage;	public $category;	public $cost;	public $descriptionTitle;	public $description;	public static $tplViewFile;	public static $multiLang = true;	public function __construct() {		$this->r_id = new stdClass();		$this->r_id->value = null;		$this->lang_id = new stdClass();		$this->lang_id->value = null;		$messages = Application::$messages['model_room_view'];		$this->mainTitle = new ModelTextField("mainTitle", $messages['field_mainTitle'], true, true);		$this->mainTitle->required = false;		$this->content = new ModelTinyMce("content", $messages['field_content'], true, true);		$this->content->required = false;		$this->date = new ModelDateField("date", $messages['field_date'], true, true);		$this->date->common = true;		$this->image = new ModelFMImageField("image", $messages['field_image'], false, true);		$this->image->required = false;		$this->image->common = true;		$this->mainImage = new ModelFMImageField("mainImage", $messages['field_mainImage'], false, true);		$this->mainImage->required = false;		$this->mainImage->common = true;		$this->category = new ModelSelectField("category", $messages['field_category'], Array(			0 => $messages['category_1'],			1 => $messages['category_2'],			2 => $messages['category_3'],			3 => $messages['category_4'],		), true, true);		$this->category->common = true;		$this->cost = new ModelTextField("cost", $messages['field_cost'], true, true);		$this->cost->required = false;		$this->descriptionTitle = new ModelTextField("descriptionTitle", $messages['field_descriptionTitle'], true, true);		$this->descriptionTitle->required = false;		$this->description = new ModelTextField("description", $messages['field_description'], true, true);		$this->description->required = false;	}	public function getSearchUrl() {		return 'roomlistview/view/' . $this->r_id->value;	}	public static function initialize() {		self::$displayFields = Array('image', 'mainImage', 'mainTitle', 'date', 'category', 'cost');		self::$title = Application::$messages['model_room_view']['title'];		self::$iconPath = 'news-icon.png';		self::$multiLang = true;		self::$searchable = true;		self::$viewUrl = 'room-list';		self::$searchSettings = Array(			'title_field' => 'mainTitle',			'content_field' => 'content',		);	}	public static function getLastNews($count, $lang = false) {		$sql = " WHERE ";		$values = Array();		$sql .= " `category` = '0' ";		if (self::$multiLang && $lang) {			$sql .= " AND `lang_id` = '{#1}'";			$values[] = $lang;		}		$sql .= "ORDER BY `date` DESC LIMIT ". intval($count);		$news = self::find($sql, $values);		$c = count($news);		for ($i = 0; $i < $c; $i++) {			$news[$i]->description = Utils::parseWords($news[$i]->content->value, 1);		}		return $news;	}	public static function getNewsWithCommentsCount($lang, $start, $limit, $category = 0) {		$sql = "SELECT `vl1_RoomListViewModel`.*, count(`vl1_NewsCommentsModel`.`newsId`) as `comments_count`			FROM `vl1_RoomListViewModel`			LEFT JOIN `vl1_NewsCommentsModel` ON `vl1_RoomListViewModel`.`r_id` = `vl1_NewsCommentsModel`.`newsId`			WHERE `vl1_RoomListViewModel`.`lang_id` = '{#1}' AND `vl1_RoomListViewModel`.`mainTitle` <> '' AND `vl1_RoomListViewModel`.`category` = '".$category."'			GROUP BY `vl1_RoomListViewModel`.`r_id` ORDER BY `vl1_RoomListViewModel`.`date` DESC LIMIT " . ($start * $limit) . "," . $limit;		$r = self::fQuery($sql, Array($lang));		$c = count($r);		for ($i = 0; $i < $c; $i++) {			$r[$i]['description'] = Utils::parseWords($r[$i]['content'], 1);		}		return $r;	}	public static function getNews($newsId, $lang) {		$news = NewsModel::get($newsId, $lang);		$sql = "				SELECT `vl1_NewsCommentsModel`.`commentText`,`vl1_NewsCommentsModel`.`date`, `vl1_SiteUsersModel`.*				FROM `vl1_NewsCommentsModel`				INNER JOIN `vl1_SiteUsersModel`				ON `vl1_NewsCommentsModel`.`userId` = `vl1_SiteUsersModel`.`id`				WHERE `vl1_NewsCommentsModel`.`newsId` = '{#1}'			";		$comments = self::fQuery($sql, Array($newsId));		return Array(			'news' => $news,			'comments' => $comments,		);	}	public static function getData($lang_id) {		$sql = "SELECT * FROM `vl1_RoomListViewModel` WHERE `lang_id` = '".$lang_id."' ";		$request = self::fQuery($sql);		return $request;	}}?>